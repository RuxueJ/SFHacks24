<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HomePage</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="video-section">
        <button onclick="turnOnCamera()">Turn On Camera</button>
        <button onclick="turnOffCamera()">Turn Off Camera</button>
        <button onclick="capturePicture()">Capture Picture</button>
        <div class="oncamera">
            <video id="videoFeed" autoplay style="display: none;"></video>
        </div>
    </div>

    <div id="popup" class="popup">
        <div class="popup-content">
            <span class="close" onclick="closePopup()">&times;</span>
            <div class="result-section">
                <h1>Results:</h1>
                <div class="img-result">
                    <div id="imagePreview"></div>
                <p id="content"></p>
                <p id="result"></p>
                </div>
            </div>
        </div>
    </div>


    <script>
        let videoStream;
        let videoElement = document.getElementById('videoFeed');
        let canvas = document.createElement('canvas');
        let context = canvas.getContext('2d');

        async function turnOnCamera() {
            try {
                const constraints = {
                    video: {
                        facingMode: { exact: 'environment' } // Specify 'environment' for the back camera
                    }
                };
                videoStream = await navigator.mediaDevices.getUserMedia(constraints);
                videoElement.srcObject = videoStream;
                videoElement.style.display = 'block';
            } catch (error) {
                console.error('Error accessing camera:', error);
                alert('Could not access the camera. Please make sure it is enabled and try again.');
            }
        }


        function turnOffCamera() {
            if (videoStream) {
                const tracks = videoStream.getTracks();
                tracks.forEach(track => track.stop());
                videoStream = null;
                videoElement.style.display = 'none';
            }
        }

        function capturePicture() {

            if (!videoStream) {
                alert('Please turn on the camera first.');
                return;
            }


            document.getElementById('popup').style.display = 'block';
            context.drawImage(videoElement, 0, 0, canvas.width, canvas.height);
            const imageData = canvas.toDataURL('image/jpeg');
            displayImage(imageData);

            const contentParagraph = document.getElementById('content');
            contentParagraph.textContent = 'Captured Image Data: ' + imageData;
        }

        function displayImage(imageData) {
            const imagePreview = document.getElementById('imagePreview');
            const img = new Image();
            img.src = imageData;
            // img.style.maxWidth = '50%';
            // img.style.maxHeight = '50%'; // Limit the height for display
            imagePreview.innerHTML = ''; // Clear previous content
            imagePreview.appendChild(img);
        }


        function closePopup() {
            document.getElementById('popup').style.display = 'none';
        }

    </script>
</body>

</html>